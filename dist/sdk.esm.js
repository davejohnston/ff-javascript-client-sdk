var Je=Object.create,Ve=Object.defineProperty,We=Object.getPrototypeOf,Ye=Object.prototype.hasOwnProperty,Qe=Object.getOwnPropertyNames,Ze=Object.getOwnPropertyDescriptor;var ae=Object.assign,et=i=>Ve(i,"__esModule",{value:!0});var tt=(i,c)=>()=>(c||(c={exports:{}},i(c.exports,c)),c.exports);var nt=(i,c,O)=>{if(c&&typeof c=="object"||typeof c=="function")for(let g of Qe(c))!Ye.call(i,g)&&g!=="default"&&Ve(i,g,{get:()=>c[g],enumerable:!(O=Ze(c,g))||O.enumerable});return i},rt=i=>nt(et(Ve(i!=null?Je(We(i)):{},"default",i&&i.__esModule&&"default"in i?{get:()=>i.default,enumerable:!0}:{value:i,enumerable:!0})),i);var Ce=(i,c,O)=>new Promise((g,X)=>{var q=A=>{try{D(O.next(A))}catch(G){X(G)}},U=A=>{try{D(O.throw(A))}catch(G){X(G)}},D=A=>A.done?g(A.value):Promise.resolve(A.value).then(q,U);D((O=O.apply(i,c)).next())});var je=tt((He,Oe)=>{(function(i){"use strict";var c=i.setTimeout,O=i.clearTimeout,g=i.XMLHttpRequest,X=i.XDomainRequest,q=i.ActiveXObject,U=i.EventSource,D=i.document,A=i.Promise,G=i.fetch,ue=i.Response,R=i.TextDecoder,N=i.TextEncoder,z=i.AbortController;if(typeof window!="undefined"&&typeof D!="undefined"&&!("readyState"in D)&&D.body==null&&(D.readyState="loading",window.addEventListener("load",function(e){D.readyState="complete"},!1)),g==null&&q!=null&&(g=function(){return new q("Microsoft.XMLHTTP")}),Object.create==null&&(Object.create=function(e){function n(){}return n.prototype=e,new n}),Date.now||(Date.now=function(){return new Date().getTime()}),z==null){var F=G;G=function(e,n){var r=n.signal;return F(e,{headers:n.headers,credentials:n.credentials,cache:n.cache}).then(function(t){var f=t.body.getReader();return r._reader=f,r._aborted&&r._reader.cancel(),{status:t.status,statusText:t.statusText,headers:t.headers,body:{getReader:function(){return f}}}})},z=function(){this.signal={_reader:null,_aborted:!1},this.abort=function(){this.signal._reader!=null&&this.signal._reader.cancel(),this.signal._aborted=!0}}}function ne(){this.bitsNeeded=0,this.codePoint=0}ne.prototype.decode=function(e){function n(p,E,d){if(d===1)return p>=128>>E&&p<<E<=2047;if(d===2)return p>=2048>>E&&p<<E<=55295||p>=57344>>E&&p<<E<=65535;if(d===3)return p>=65536>>E&&p<<E<=1114111;throw new Error}function r(p,E){if(p===6*1)return E>>6>15?3:E>31?2:1;if(p===6*2)return E>15?3:2;if(p===6*3)return 3;throw new Error}for(var t=65533,f="",a=this.bitsNeeded,u=this.codePoint,y=0;y<e.length;y+=1){var v=e[y];a!==0&&(v<128||v>191||!n(u<<6|v&63,a-6,r(a,u)))&&(a=0,u=t,f+=String.fromCharCode(u)),a===0?(v>=0&&v<=127?(a=0,u=v):v>=192&&v<=223?(a=6*1,u=v&31):v>=224&&v<=239?(a=6*2,u=v&15):v>=240&&v<=247?(a=6*3,u=v&7):(a=0,u=t),a!==0&&!n(u,a,r(a,u))&&(a=0,u=t)):(a-=6,u=u<<6|v&63),a===0&&(u<=65535?f+=String.fromCharCode(u):(f+=String.fromCharCode(55296+(u-65535-1>>10)),f+=String.fromCharCode(56320+(u-65535-1&1023))))}return this.bitsNeeded=a,this.codePoint=u,f};var Ne=function(){try{return new R().decode(new N().encode("test"),{stream:!0})==="test"}catch(e){console.debug("TextDecoder does not support streaming option. Using polyfill instead: "+e)}return!1};(R==null||N==null||!Ne())&&(R=ne);var x=function(){};function S(e){this.withCredentials=!1,this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=x,this.onload=x,this.onerror=x,this.onreadystatechange=x,this._contentType="",this._xhr=e,this._sendTimeout=0,this._abort=x}S.prototype.open=function(e,n){this._abort(!0);var r=this,t=this._xhr,f=1,a=0;this._abort=function(d){r._sendTimeout!==0&&(O(r._sendTimeout),r._sendTimeout=0),(f===1||f===2||f===3)&&(f=4,t.onload=x,t.onerror=x,t.onabort=x,t.onprogress=x,t.onreadystatechange=x,t.abort(),a!==0&&(O(a),a=0),d||(r.readyState=4,r.onabort(null),r.onreadystatechange())),f=0};var u=function(){if(f===1){var d=0,m="",Y=void 0;if("contentType"in t)d=200,m="OK",Y=t.contentType;else try{d=t.status,m=t.statusText,Y=t.getResponseHeader("Content-Type")}catch(ge){d=0,m="",Y=void 0}d!==0&&(f=2,r.readyState=2,r.status=d,r.statusText=m,r._contentType=Y,r.onreadystatechange())}},y=function(){if(u(),f===2||f===3){f=3;var d="";try{d=t.responseText}catch(m){}r.readyState=3,r.responseText=d,r.onprogress()}},v=function(d,m){if((m==null||m.preventDefault==null)&&(m={preventDefault:x}),y(),f===1||f===2||f===3){if(f=4,a!==0&&(O(a),a=0),r.readyState=4,d==="load")r.onload(m);else if(d==="error")r.onerror(m);else if(d==="abort")r.onabort(m);else throw new TypeError;r.onreadystatechange()}},p=function(d){t!=null&&(t.readyState===4?(!("onload"in t)||!("onerror"in t)||!("onabort"in t))&&v(t.responseText===""?"error":"load",d):t.readyState===3?"onprogress"in t||y():t.readyState===2&&u())},E=function(){a=c(function(){E()},500),t.readyState===3&&y()};"onload"in t&&(t.onload=function(d){v("load",d)}),"onerror"in t&&(t.onerror=function(d){v("error",d)}),"onabort"in t&&(t.onabort=function(d){v("abort",d)}),"onprogress"in t&&(t.onprogress=y),"onreadystatechange"in t&&(t.onreadystatechange=function(d){p(d)}),("contentType"in t||!("ontimeout"in g.prototype))&&(n+=(n.indexOf("?")===-1?"?":"&")+"padding=true"),t.open(e,n,!0),"readyState"in t&&(a=c(function(){E()},0))},S.prototype.abort=function(){this._abort(!1)},S.prototype.getResponseHeader=function(e){return this._contentType},S.prototype.setRequestHeader=function(e,n){var r=this._xhr;"setRequestHeader"in r&&r.setRequestHeader(e,n)},S.prototype.getAllResponseHeaders=function(){return this._xhr.getAllResponseHeaders!=null&&this._xhr.getAllResponseHeaders()||""},S.prototype.send=function(){if((!("ontimeout"in g.prototype)||!("sendAsBinary"in g.prototype)&&!("mozAnon"in g.prototype))&&D!=null&&D.readyState!=null&&D.readyState!=="complete"){var e=this;e._sendTimeout=c(function(){e._sendTimeout=0,e.send()},4);return}var n=this._xhr;"withCredentials"in n&&(n.withCredentials=this.withCredentials);try{n.send(void 0)}catch(r){throw r}};function le(e){return e.replace(/[A-Z]/g,function(n){return String.fromCharCode(n.charCodeAt(0)+32)})}function j(e){for(var n=Object.create(null),r=e.split(`\r
`),t=0;t<r.length;t+=1){var f=r[t],a=f.split(": "),u=a.shift(),y=a.join(": ");n[le(u)]=y}this._map=n}j.prototype.get=function(e){return this._map[le(e)]},g!=null&&g.HEADERS_RECEIVED==null&&(g.HEADERS_RECEIVED=2);function me(){}me.prototype.open=function(e,n,r,t,f,a,u){e.open("GET",f);var y=0;e.onprogress=function(){var p=e.responseText,E=p.slice(y);y+=E.length,r(E)},e.onerror=function(p){p.preventDefault(),t(new Error("NetworkError"))},e.onload=function(){t(null)},e.onabort=function(){t(null)},e.onreadystatechange=function(){if(e.readyState===g.HEADERS_RECEIVED){var p=e.status,E=e.statusText,d=e.getResponseHeader("Content-Type"),m=e.getAllResponseHeaders();n(p,E,d,new j(m))}},e.withCredentials=a;for(var v in u)Object.prototype.hasOwnProperty.call(u,v)&&e.setRequestHeader(v,u[v]);return e.send(),e};function ve(e){this._headers=e}ve.prototype.get=function(e){return this._headers.get(e)};function Se(){}Se.prototype.open=function(e,n,r,t,f,a,u){var y=null,v=new z,p=v.signal,E=new R;return G(f,{headers:u,credentials:a?"include":"same-origin",signal:p,cache:"no-store"}).then(function(d){return y=d.body.getReader(),n(d.status,d.statusText,d.headers.get("Content-Type"),new ve(d.headers)),new A(function(m,Y){var ge=function(){y.read().then(function(k){if(k.done)m(void 0);else{var V=E.decode(k.value,{stream:!0});r(V),ge()}}).catch(function(k){Y(k)})};ge()})}).catch(function(d){if(d.name!=="AbortError")return d}).then(function(d){t(d)}),{abort:function(){y!=null&&y.cancel(),v.abort()}}};function re(){this._listeners=Object.create(null)}function be(e){c(function(){throw e},0)}re.prototype.dispatchEvent=function(e){e.target=this;var n=this._listeners[e.type];if(n!=null)for(var r=n.length,t=0;t<r;t+=1){var f=n[t];try{typeof f.handleEvent=="function"?f.handleEvent(e):f.call(this,e)}catch(a){be(a)}}},re.prototype.addEventListener=function(e,n){e=String(e);var r=this._listeners,t=r[e];t==null&&(t=[],r[e]=t);for(var f=!1,a=0;a<t.length;a+=1)t[a]===n&&(f=!0);f||t.push(n)},re.prototype.removeEventListener=function(e,n){e=String(e);var r=this._listeners,t=r[e];if(t!=null){for(var f=[],a=0;a<t.length;a+=1)t[a]!==n&&f.push(t[a]);f.length===0?delete r[e]:r[e]=f}};function te(e){this.type=e,this.target=void 0}function he(e,n){te.call(this,e),this.data=n.data,this.lastEventId=n.lastEventId}he.prototype=Object.create(te.prototype);function o(e,n){te.call(this,e),this.status=n.status,this.statusText=n.statusText,this.headers=n.headers}o.prototype=Object.create(te.prototype);function s(e,n){te.call(this,e),this.error=n.error}s.prototype=Object.create(te.prototype);var h=-1,l=0,M=1,b=2,w=-1,T=0,J=1,oe=2,pe=3,we=/^text\/event\-stream(;.*)?$/i,$e=1e3,Ue=18e6,_e=function(e,n){var r=e==null?n:parseInt(e,10);return r!==r&&(r=n),Fe(r)},Fe=function(e){return Math.min(Math.max(e,$e),Ue)},se=function(e,n,r){try{typeof n=="function"&&n.call(e,r)}catch(t){be(t)}};function W(e,n){re.call(this),n=n||{},this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,this.url=void 0,this.readyState=void 0,this.withCredentials=void 0,this.headers=void 0,this._close=void 0,qe(this,e,n)}function Ke(){return g!=null&&"withCredentials"in g.prototype||X==null?new g:new X}var Xe=G!=null&&ue!=null&&"body"in ue.prototype;function qe(e,n,r){n=String(n);var t=Boolean(r.withCredentials),f=r.lastEventIdQueryParameterName||"lastEventId",a=Fe(1e3),u=_e(r.heartbeatTimeout,45e3),y="",v=a,p=!1,E=0,d=r.headers||{},m=r.Transport,Y=Xe&&m==null?void 0:new S(m!=null?new m:Ke()),ge=m!=null&&typeof m!="string"?new m:Y==null?new Se:new me,k=void 0,V=0,K=h,fe="",Te="",Q="",Re="",H=T,xe=0,ie=0,Ge=function(I,C,B,$){if(K===l)if(I===200&&B!=null&&we.test(B)){K=M,p=Date.now(),v=a,e.readyState=M;var L=new o("open",{status:I,statusText:C,headers:$});e.dispatchEvent(L),se(e,e.onopen,L)}else{var _="";I!==200?(C&&(C=C.replace(/\s+/g," ")),_="EventSource's response has a status "+I+" "+C+" that is not 200. Aborting the connection."):_="EventSource's response has a Content-Type specifying an unsupported type: "+(B==null?"-":B.replace(/\s+/g," "))+". Aborting the connection.",Me();var L=new o("error",{status:I,statusText:C,headers:$});e.dispatchEvent(L),se(e,e.onerror,L),console.error(_)}},ze=function(I){if(K===M){for(var C=-1,B=0;B<I.length;B+=1){var $=I.charCodeAt(B);($===`
`.charCodeAt(0)||$==="\r".charCodeAt(0))&&(C=B)}var L=(C!==-1?Re:"")+I.slice(0,C+1);Re=(C===-1?Re:"")+I.slice(C+1),I!==""&&(p=Date.now(),E+=I.length);for(var _=0;_<L.length;_+=1){var $=L.charCodeAt(_);if(H===w&&$===`
`.charCodeAt(0))H=T;else if(H===w&&(H=T),$==="\r".charCodeAt(0)||$===`
`.charCodeAt(0)){if(H!==T){H===J&&(ie=_+1);var Z=L.slice(xe,ie-1),ee=L.slice(ie+(ie<_&&L.charCodeAt(ie)===" ".charCodeAt(0)?1:0),_);Z==="data"?(fe+=`
`,fe+=ee):Z==="id"?Te=ee:Z==="event"?Q=ee:Z==="retry"?(a=_e(ee,a),v=a):Z==="heartbeatTimeout"&&(u=_e(ee,u),V!==0&&(O(V),V=c(function(){Ee()},u)))}if(H===T){if(fe!==""){y=Te,Q===""&&(Q="message");var de=new he(Q,{data:fe.slice(1),lastEventId:Te});if(e.dispatchEvent(de),Q==="open"?se(e,e.onopen,de):Q==="message"?se(e,e.onmessage,de):Q==="error"&&se(e,e.onerror,de),K===b)return}fe="",Q=""}H=$==="\r".charCodeAt(0)?w:T}else H===T&&(xe=_,H=J),H===J?$===":".charCodeAt(0)&&(ie=_+1,H=oe):H===oe&&(H=pe)}}},Pe=function(I){if(K===M||K===l)K=h,V!==0&&(O(V),V=0),V=c(function(){Ee()},v),v=Fe(Math.min(a*16,v*2)),e.readyState=l;else if(K===b&&I!=null){console.error(I);var C=new s("error",{error:I});e.dispatchEvent(C),se(e,e.onerror,C)}},Me=function(){K=b,k!=null&&(k.abort(),k=void 0),V!==0&&(O(V),V=0),e.readyState=b},Ee=function(){if(V=0,K!==h){if(!p&&k!=null)Pe(new Error("No activity within "+u+" milliseconds. "+(K===l?"No response received.":E+" chars received.")+" Reconnecting.")),k!=null&&(k.abort(),k=void 0);else{var I=Math.max((p||Date.now())+u-Date.now(),1);p=!1,V=c(function(){Ee()},I)}return}p=!1,E=0,V=c(function(){Ee()},u),K=l,fe="",Q="",Te=y,Re="",xe=0,ie=0,H=T;var C=n;if(n.slice(0,5)!=="data:"&&n.slice(0,5)!=="blob:"&&y!==""){var B=n.indexOf("?");C=B===-1?n:n.slice(0,B+1)+n.slice(B+1).replace(/(?:^|&)([^=&]*)(?:=[^&]*)?/g,function(ee,de){return de===f?"":ee}),C+=(n.indexOf("?")===-1?"?":"&")+f+"="+encodeURIComponent(y)}var $=e.withCredentials,L={};L.Accept="text/event-stream";var _=e.headers;if(_!=null)for(var Z in _)Object.prototype.hasOwnProperty.call(_,Z)&&(L[Z]=_[Z]);try{k=ge.open(Y,Ge,ze,Pe,C,$,L)}catch(ee){throw Me(),ee}};e.url=n,e.readyState=l,e.withCredentials=t,e.headers=d,e._close=Me,Ee()}W.prototype=Object.create(re.prototype),W.prototype.CONNECTING=l,W.prototype.OPEN=M,W.prototype.CLOSED=b,W.prototype.close=function(){this._close()},W.CONNECTING=l,W.OPEN=M,W.CLOSED=b,W.prototype.withCredentials=void 0;var Le=U;g!=null&&(U==null||!("withCredentials"in U.prototype))&&(Le=W),function(e){if(typeof Oe=="object"&&typeof Oe.exports=="object"){var n=e(He);n!==void 0&&(Oe.exports=n)}else typeof define=="function"&&define.amd?define(["exports"],e):e(i)}(function(e){e.EventSourcePolyfill=W,e.NativeEventSource=U,e.EventSource=Le})})(typeof globalThis=="undefined"?typeof window!="undefined"?window:typeof self!="undefined"?self:He:globalThis)});var Be=rt(je());import it from"jwt-decode";import at from"mitt";var P;(function(i){i.READY="ready",i.CONNECTED="connected",i.DISCONNECTED="disconnected",i.CHANGED="changed",i.ERROR="error"})(P||(P={}));var ke={debug:!1,baseUrl:"https://config.ff.harness.io/api/1.0",eventUrl:"https://events.ff.harness.io/api/1.0",streamEnabled:!0,allAttributesPrivate:!1,privateAttributeNames:[]},ce=(i,...c)=>console.error(`[FF-SDK] ${i}`,...c),Ae=30*1e3;var ot="1.4.6",st=500,Ie=globalThis.fetch,ft=Be.EventSourcePolyfill,ye=!!globalThis.Proxy,De=i=>{let{value:c}=i;try{switch(i.kind.toLowerCase()){case"int":case"number":c=Number(c);break;case"boolean":c=c.toString().toLowerCase()==="true";break;case"json":c=JSON.parse(c);break}}catch(O){ce(O)}return c},dt=(i,c,O)=>{let g,X,q,U,D,A=!0,G=()=>{A=!1},ue=()=>{A=!0},R=[],N=at(),z=ae(ae({},ke),O),F=(o,...s)=>{z.debug&&console.debug(`[FF-SDK] ${o}`,...s)},ne=o=>{if(A){let s=Date.now();s-o.lastAccessed>st&&(o.count++,o.lastAccessed=s)}};globalThis.onbeforeunload=()=>{R.length&&globalThis.localStorage&&(G(),globalThis.localStorage.HARNESS_FF_METRICS=JSON.stringify(R),ue())};let Ne=(o,s)=>Ce(void 0,null,function*(){return(yield(yield Ie(`${s.baseUrl}/client/auth`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:o,target:c})})).json()).authToken}),x=()=>{if(R.length){F("Sending metrics...",{metrics:R,evaluations:S});let o={metricsData:R.map(s=>({timestamp:Date.now(),count:s.count,metricsType:"FFMETRICS",attributes:[{key:"featureIdentifier",value:s.featureIdentifier},{key:"featureName",value:s.featureIdentifier},{key:"variationIdentifier",value:s.variationIdentifier},{key:"target",value:c.identifier},{key:"SDK_NAME",value:"JavaScript"},{key:"SDK_TYPE",value:"client"},{key:"SDK_VERSION",value:ot}]}))};Ie(`${z.eventUrl}/metrics/${g}?cluster=${X}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${U}`},body:JSON.stringify(o)}).then(()=>{R=[]}).catch(s=>{F(s)}).finally(()=>{D=window.setTimeout(x,Ae)})}else D=window.setTimeout(x,Ae)},S={},le=function(){return ye?new Proxy({},{get(o,s){var l,M,b;let h=o[s];if(o.hasOwnProperty(s)){let w=o[s],T=R.find(J=>J.featureIdentifier===s&&w===J.featureValue);T?(T.variationIdentifier=((l=S[s])==null?void 0:l.identifier)||"",ne(T)):R.push({featureIdentifier:s,featureValue:w,variationIdentifier:((M=S[s])==null?void 0:M.identifier)||"",count:A?1:0,lastAccessed:Date.now()}),F("Metrics event: Flag:",s,"has been read with value:",w,"variationIdentifier:",(b=S[s])==null?void 0:b.identifier)}return h}}):{}},j=le();Ne(i,z).then(o=>{U=o;let s=it(o);if(F("Authenticated",s),globalThis.localStorage&&globalThis.localStorage.HARNESS_FF_METRICS)try{delete globalThis.localStorage.HARNESS_FF_METRICS,F("Picking up metrics from previous session")}catch(h){}D=window.setTimeout(x,Ae),g=s.environment,X=s.clusterIdentifier,me().then(()=>{F("Fetch all flags ok",j)}).then(()=>{Se()}).then(()=>{F("Event stream ready",{storage:j}),N.emit(P.READY,j),ye||Object.keys(j).forEach(h=>{var l;R.push({featureIdentifier:h,featureValue:j[h],variationIdentifier:((l=S[h])==null?void 0:l.identifier)||"",count:A?1:0,lastAccessed:Date.now()})})}).catch(h=>{N.emit(P.ERROR,h)})}).catch(o=>{ce("Authentication error: ",o),N.emit(P.ERROR,o)});let me=()=>Ce(void 0,null,function*(){try{(yield(yield Ie(`${z.baseUrl}/client/env/${g}/target/${c.identifier}/evaluations?cluster=${X}`,{headers:{Authorization:`Bearer ${U}`}})).json()).forEach(h=>{let l=De(h);j[h.flag]=l,S[h.flag]=ae(ae({},h),{value:l})})}catch(o){return ce("Features fetch operation error: ",o),N.emit(P.ERROR,o),o}}),ve=o=>Ce(void 0,null,function*(){var s;try{let h=yield Ie(`${z.baseUrl}/client/env/${g}/target/${c.identifier}/evaluations/${o}?cluster=${X}`,{headers:{Authorization:`Bearer ${U}`}});if(h.ok){let l=yield h.json(),M=De(l);if(G(),j[o]=M,S[o]=ae(ae({},l),{value:M}),ue(),N.emit(P.CHANGED,ye?new Proxy(l,{get(b,w){var T;if(b.hasOwnProperty(w)&&w==="value"){let J=b.flag,oe=l.value,pe=R.find(we=>we.featureIdentifier===J&&we.featureValue===oe);pe?(ne(pe),pe.variationIdentifier=((T=S[J])==null?void 0:T.identifier)||""):R.push({featureIdentifier:J,featureValue:String(oe),variationIdentifier:S[J].identifier||"",count:A?1:0,lastAccessed:Date.now()}),F("Metrics event: Flag",w,"has been read with value via stream update",oe)}return w==="value"?De(l):l[w]}}):{deleted:l.deleted,flag:l.flag,value:De(l)}),!ye){let b=l.flag,w=R.find(T=>T.featureIdentifier===b&&T.featureValue===l.value);w?(ne(w),w.variationIdentifier=((s=S[b])==null?void 0:s.identifier)||""):R.push({featureIdentifier:b,featureValue:String(l.value),variationIdentifier:S[b].identifier||"",count:A?1:0,lastAccessed:Date.now()})}}else N.emit(P.ERROR,h)}catch(h){ce("Feature fetch operation error: ",h),N.emit(P.ERROR,h)}}),Se=()=>{if(!z.streamEnabled){F("Stream is disabled by configuration. Note: Polling is not yet supported");return}q=new ft(`${z.baseUrl}/stream?cluster=${X}`,{headers:{Authorization:`Bearer ${U}`,"API-Key":i}}),q.onopen=o=>{F("Stream connected",o),N.emit(P.CONNECTED)},q.onclose=o=>{F("Stream disconnected"),N.emit(P.DISCONNECTED)},q.onerror=o=>{ce("Stream has issue",o),N.emit(P.ERROR,o)},q.addEventListener("*",o=>{let s=JSON.parse(o.data);switch(F("Received event from stream: ",s),s.event){case"create":setTimeout(()=>ve(s.identifier),1e3);break;case"patch":ve(s.identifier);break;case"delete":delete j[s.identifier],N.emit(P.CHANGED,{flag:s.identifier,value:void 0,deleted:!0}),F("Evaluation deleted",{message:s,storage:j});break}})},re=(o,s)=>N.on(o,s),be=(o,s)=>{o?N.off(o,s):he()},te=(o,s)=>{var l;let h=j[o];if(!ye&&h!==void 0){let M=h,b=o,w=R.find(T=>T.featureIdentifier===b&&T.featureValue===M);w?(ne(w),w.variationIdentifier=((l=S[b])==null?void 0:l.identifier)||""):R.push({featureIdentifier:b,featureValue:M,count:A?1:0,variationIdentifier:S[b].identifier||"",lastAccessed:Date.now()})}return h!==void 0?h:s},he=()=>{F("Closing event stream"),j=le(),S={},clearTimeout(D),N.all.clear(),q.close()};return{on:re,off:be,variation:te,close:he}};export{P as Event,dt as initialize};
/** @license
 * eventsource.js
 * Available under MIT License (MIT)
 * https://github.com/Yaffle/EventSource/
 */
//# sourceMappingURL=sdk.esm.js.map
